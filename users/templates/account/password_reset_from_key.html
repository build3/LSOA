{% extends "account/base.html" %}

{% block content %}
  <div class="cls-content">
    <div class="cls-content-sm panel">
      <div class="panel-body">
        <div class="mar-ver pad-btm">
          <h1 class="h3">{% block title %}
            {% if token_fail %}
              Bad Password Reset Link
            {% else %}
              Change Password
            {% endif %}
          {% endblock %}</h1>
          {% if token_fail %}
            <p>The password reset link was invalid, possibly because it has already been used.</p>
          {% else %}
            <p>Fill out the following form to reset your password</p>
          {% endif %}
        </div>
        {% if token_fail %}
          <div class="pad-all">
            <a href="{% url 'account_reset_password' %}" class="btn-link">Request New Password Reset</a>
          </div>
        {% else %}
          <form action="{{ action_url }}" method="POST">
            {# HIDDEN FIELDS, CSRF TOKEN, NON-FIELD ERRORS #}
            {% csrf_token %}
            {% for error in form.non_field_errors %}
              <div class="alert alert-danger mt-2">{{ error|escape }}</div>
            {% endfor %}

            {# PASSWORD 1 FIELD #}
            <div class="form-group">
              <input name="password1" type="password" class="form-control" placeholder="Password" autofocus>
            </div>
            {% for error in form.password1.errors %}
              <div class="alert alert-danger mt-2">{{ error|escape }}</div>
            {% endfor %}

            {# PASSWORD 2 FIELD #}
            <div class="form-group">
              <input name="password2" type="password" class="form-control" placeholder="Password (again)">
            </div>
            {% for error in form.password2.errors %}
              <div class="alert alert-danger mt-2">{{ error|escape }}</div>
            {% endfor %}

            {# SUBMIT BUTTON #}
            <button class="btn btn-primary btn-lg btn-block" type="submit">Change Password</button>
          </form>
        {% endif %}
      </div>

      <div class="pad-all">
        <a href="{% url 'account_login' %}" class="btn-link">Go back to sign in</a>
      </div>
    </div>
  </div>
{% endblock %}
